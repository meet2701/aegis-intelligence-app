{% extends "base.html" %}

{% block title %}Regional Bounty Average - AEGIS{% endblock %}

{% block content %}
<div class="card-custom">
    <a href="{{ url_for('tactical_analysis') }}" class="btn btn-custom" style="margin-bottom: 2rem;">
        ‚Üê Back to Tactical Analysis Hub
    </a>
    
    <div class="card-header-custom" style="background: linear-gradient(135deg, #1a0033, #330066); border-color: #cc66ff;">
        üåä REGIONAL BOUNTY ANALYSIS
    </div>
    
    <p style="text-align: center; color: var(--text-secondary); margin-bottom: 2rem;">
        Analyze pirate activity by sea region based on home island
    </p>
    
    <!-- Region Selection Form -->
    <form method="POST" class="form-custom" style="margin-bottom: 2rem;">
        <div class="row">
            <div class="col-md-8">
                <label for="region_id" class="form-label">Select Sea Region:</label>
                <select name="region_id" id="region_id" class="form-control" required>
                    <option value="">-- Choose a Region --</option>
                    {% for region in regions %}
                        <option value="{{ region.Region_ID }}" {% if region_id|string == region.Region_ID|string %}selected{% endif %}>
                            {{ region.Region_Name }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-4" style="display: flex; align-items: flex-end;">
                <button type="submit" class="btn btn-custom w-100">üìä Analyze</button>
            </div>
        </div>
    </form>
    
    <hr style="border-color: var(--border-color); margin: 2rem 0;">
    
    <!-- Results -->
    {% if results is string %}
        <div class="alert alert-warning">{{ results }}</div>
    {% elif results %}
        {% for region in results %}
        <div style="background: linear-gradient(135deg, rgba(26, 0, 51, 0.5), rgba(51, 0, 102, 0.5)); border: 3px solid #cc66ff; border-radius: 15px; padding: 2rem; margin-bottom: 2rem;">
            <h2 style="color: #cc66ff; text-align: center; margin-bottom: 2rem; font-size: 2rem;">
                üåä {{ region.Region_Name }}
            </h2>
            
            <!-- Statistics Grid -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 2rem;">
                <!-- Total Pirates -->
                <div style="background: rgba(0, 0, 0, 0.3); padding: 1.5rem; border-radius: 10px; border: 2px solid #cc66ff; text-align: center;">
                    <div style="font-size: 2.5rem; color: #cc66ff; font-weight: bold;">{{ region.Total_Pirates }}</div>
                    <div style="color: var(--text-secondary); margin-top: 0.5rem;">Total Pirates</div>
                    <div style="color: var(--text-muted); font-size: 0.9rem; margin-top: 0.3rem;">from this region</div>
                </div>
                
                <!-- Average Bounty -->
                <div style="background: rgba(255, 165, 0, 0.2); padding: 1.5rem; border-radius: 10px; border: 2px solid #ff9900; text-align: center;">
                    <div style="font-size: 1.4rem; color: #ff9900; font-weight: bold; word-break: break-word; line-height: 1.2;">
                        ‡∏ø{{ "{:,}".format(region.Average_Bounty|int if region.Average_Bounty else 0) }}
                    </div>
                    <div style="color: var(--text-secondary); margin-top: 0.5rem;">Average Bounty</div>
                    <div style="color: var(--text-muted); font-size: 0.9rem; margin-top: 0.3rem;">per pirate</div>
                </div>
                
                <!-- Total Regional Threat -->
                <div style="background: rgba(255, 0, 0, 0.2); padding: 1.5rem; border-radius: 10px; border: 2px solid #ff0000; text-align: center;">
                    <div style="font-size: 1.4rem; color: #ff0000; font-weight: bold; word-break: break-word; line-height: 1.2;">
                        ‡∏ø{{ "{:,}".format(region.Total_Regional_Bounty|int if region.Total_Regional_Bounty else 0) }}
                    </div>
                    <div style="color: var(--text-secondary); margin-top: 0.5rem;">Combined Bounty</div>
                    <div style="color: var(--text-muted); font-size: 0.9rem; margin-top: 0.3rem;">total threat value</div>
                </div>
                
                <!-- Highest Individual -->
                <div style="background: rgba(255, 255, 0, 0.1); padding: 1.5rem; border-radius: 10px; border: 2px solid #ffff00; text-align: center;">
                    <div style="font-size: 1.4rem; color: #ffff00; font-weight: bold; word-break: break-word; line-height: 1.2;">
                        ‡∏ø{{ "{:,}".format(region.Maximum_Bounty|int if region.Maximum_Bounty else 0) }}
                    </div>
                    <div style="color: var(--text-secondary); margin-top: 0.5rem;">Highest Bounty</div>
                    <div style="color: var(--text-muted); font-size: 0.9rem; margin-top: 0.3rem;">regional maximum</div>
                </div>
                
                <!-- Lowest Individual -->
                <div style="background: rgba(0, 255, 255, 0.1); padding: 1.5rem; border-radius: 10px; border: 2px solid #00ccff; text-align: center;">
                    <div style="font-size: 1.4rem; color: #00ccff; font-weight: bold; word-break: break-word; line-height: 1.2;">
                        ‡∏ø{{ "{:,}".format(region.Minimum_Bounty|int if region.Minimum_Bounty else 0) }}
                    </div>
                    <div style="color: var(--text-secondary); margin-top: 0.5rem;">Lowest Bounty</div>
                    <div style="color: var(--text-muted); font-size: 0.9rem; margin-top: 0.3rem;">regional minimum</div>
                </div>
            </div>
            
            <!-- Regional Assessment -->
            <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(204, 102, 255, 0.1); border: 2px solid #cc66ff; border-radius: 10px;">
                <h3 style="color: #cc66ff; margin-bottom: 1rem;">üéØ Regional Threat Profile</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; color: var(--text-secondary); line-height: 1.8;">
                    <div>
                        <strong style="color: #cc66ff;">Activity Level:</strong>
                        {% if region.Total_Pirates > 20 %}
                            <span style="color: #ff0000;">CRITICAL</span> ({{ region.Total_Pirates }} active)
                        {% elif region.Total_Pirates > 10 %}
                            <span style="color: #ff9900;">HIGH</span> ({{ region.Total_Pirates }} active)
                        {% elif region.Total_Pirates > 5 %}
                            <span style="color: #ffff00;">MODERATE</span> ({{ region.Total_Pirates }} active)
                        {% else %}
                            <span style="color: #00ff00;">LOW</span> ({{ region.Total_Pirates }} active)
                        {% endif %}
                    </div>
                    <div>
                        <strong style="color: #cc66ff;">Bounty Density:</strong>
                        {% if region.Average_Bounty and region.Average_Bounty > 500000000 %}
                            <span style="color: #ff0000;">Extremely Dangerous</span>
                        {% elif region.Average_Bounty and region.Average_Bounty > 100000000 %}
                            <span style="color: #ff9900;">Highly Dangerous</span>
                        {% elif region.Average_Bounty and region.Average_Bounty > 50000000 %}
                            <span style="color: #ffff00;">Moderately Dangerous</span>
                        {% else %}
                            <span style="color: #00ff00;">Standard Threat</span>
                        {% endif %}
                    </div>
                </div>
                
                <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color);">
                    <strong style="color: #cc66ff;">Recommended Action:</strong>
                    <p style="margin-top: 0.5rem;">
                        {% if region.Average_Bounty and region.Average_Bounty > 500000000 %}
                            Deploy Admiral fleet to this region. Establish permanent surveillance network.
                        {% elif region.Average_Bounty and region.Average_Bounty > 100000000 %}
                            Increase Vice Admiral patrols. Monitor for crew formations.
                        {% elif region.Average_Bounty and region.Average_Bounty > 50000000 %}
                            Maintain standard patrol routes. Flag high-value targets for tracking.
                        {% else %}
                            Continue routine observation. No elevated response required.
                        {% endif %}
                    </p>
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="alert alert-info" style="text-align: center;">
            <p><strong>üó∫Ô∏è Select a sea region above to view bounty statistics</strong></p>
        </div>
    {% endif %}
</div>
{% endblock %}
